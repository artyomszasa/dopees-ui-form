var __decorate = this && this.__decorate || function (decorators, target, key, desc) {
  var c = arguments.length,
      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,
      d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
  return c > 3 && r && Object.defineProperty(target, key, r), r;
};

var DateRangePicker_1;
import "./date-range-field.js";
import { customElement, property, query, observe } from "@polymer/decorators/lib/decorators.js";
import { sprintf } from "dopees-core/lib/string.js";
import { Picker } from "./picker.js";
let DateRangePicker = DateRangePicker_1 = class DateRangePicker extends Picker {
  constructor() {
    super();
    this.value = {};

    this.selection = () => false;

    this.formatter = x => {
      if (!x) {
        return this.placeholder || '';
      }

      if (x.start) {
        if (x.end) {
          return sprintf('%04d. %02d. %02d -- %04d. %02d. %02d', x.start.year, x.start.month, x.start.day, x.end.year, x.end.month, x.end.day);
        }

        return sprintf('%04d. %02d. %02d', x.start.year, x.start.month, x.start.day);
      }

      if (x.end) {
        return sprintf('%04d. %02d. %02d', x.end.year, x.end.month, x.end.day);
      }

      return this.placeholder || '';
    };
  }

  static get template() {
    return Picker.createTemplate(DateRangePicker_1, {
      implementation: 'dope-date-range-field',
      arguments: {
        years: '[[years]]',
        months: '[[months]]',
        selection: '[[selection]]',
        value: '{{value}}',
        'start-date': '{{startDate}}',
        'end-date': '{{endDate}}'
      }
    });
  }

  activate() {
    this.wrapper.focus();
    this.innerField.activate();
  }

  forceEmpty(empty) {
    this.dropDown.forcedEmpty = empty;
  }

  observeEmpty(value) {
    this.empty = !value || !(value.start || value.end);
  }

  valueChanged(value) {
    this.__valueChanging = true;

    try {
      this.startDate = value.start;
      this.endDate = value.end;
    } finally {
      this.__valueChanging = false;
    }
  }

  valuesChanged(start, end) {
    if (start) {
      if (end) {
        this.selection = date => 0 <= date.compareTo(start) && 0 >= date.compareTo(end);
      } else {
        this.selection = date => date.equalsTo(start);
      }
    } else {
      if (end) {
        this.selection = date => date.equalsTo(end);
      } else {
        this.selection = () => false;
      }
    }

    if (!this.__valueChanging) {
      this.value = {
        start,
        end
      };
    }
  }

};

__decorate([property({
  type: Object,
  notify: true
})], DateRangePicker.prototype, "value", void 0);

__decorate([property({
  type: Object,
  notify: true
})], DateRangePicker.prototype, "startDate", void 0);

__decorate([property({
  type: Object,
  notify: true
})], DateRangePicker.prototype, "endDate", void 0);

__decorate([property()], DateRangePicker.prototype, "formatter", void 0);

__decorate([property()], DateRangePicker.prototype, "selection", void 0);

__decorate([query('dope-date-range-field')], DateRangePicker.prototype, "innerField", void 0);

__decorate([observe('empty')], DateRangePicker.prototype, "forceEmpty", null);

__decorate([observe('value')], DateRangePicker.prototype, "observeEmpty", null);

__decorate([observe('value')], DateRangePicker.prototype, "valueChanged", null);

__decorate([observe('startDate', 'endDate')], DateRangePicker.prototype, "valuesChanged", null);

DateRangePicker = DateRangePicker_1 = __decorate([customElement('dope-date-range-picker')], DateRangePicker);
export { DateRangePicker };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LEVBQUU7QUFBdkIsQ0FBRCxDQUNULENBQUEsRSx5QkFBQSxFLFNBQUEsRSxLQUE0QixDQUE1QixDQUFBOztBQUdBLFVBQUEsQ0FBQSxDQURDLFFBQVEsRUFDVCxDQUFBLEUseUJBQUEsRSxXQUFBLEUsS0FBMkMsQ0FBM0MsQ0FBQTs7QUFHQSxVQUFBLENBQUEsQ0FEQyxRQUFRLEVBQ1QsQ0FBQSxFLHlCQUFBLEUsV0FBQSxFLEtBQW9ELENBQXBELENBQUE7O0FBR0EsVUFBQSxDQUFBLENBREMsS0FBSyxDQUFDLHVCQUFELENBQ04sQ0FBQSxFLHlCQUFBLEUsWUFBQSxFLEtBQXVCLENBQXZCLENBQUE7O0FBa0NBLFVBQUEsQ0FBQSxDQURDLE9BQU8sQ0FBQyxPQUFELENBQ1IsQ0FBQSxFLHlCQUFBLEUsWUFBQSxFQUVDLElBRkQsQ0FBQTs7QUFLQSxVQUFBLENBQUEsQ0FEQyxPQUFPLENBQUMsT0FBRCxDQUNSLENBQUEsRSx5QkFBQSxFLGNBQUEsRUFFQyxJQUZELENBQUE7O0FBS0EsVUFBQSxDQUFBLENBREMsT0FBTyxDQUFDLE9BQUQsQ0FDUixDQUFBLEUseUJBQUEsRSxjQUFBLEVBUUMsSUFSRCxDQUFBOztBQVdBLFVBQUEsQ0FBQSxDQURDLE9BQU8sQ0FBQyxXQUFELEVBQWMsU0FBZCxDQUNSLENBQUEsRSx5QkFBQSxFLGVBQUEsRUFpQkMsSUFqQkQsQ0FBQTs7QUF4RlcsZUFBZSxHQUFBLGlCQUFBLEdBQUEsVUFBQSxDQUFBLENBRDNCLGFBQWEsQ0FBQyx3QkFBRCxDQUNjLENBQUEsRUFBZixlQUFlLENBQWY7U0FBQSxlIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICcuL2RhdGUtcmFuZ2UtZmllbGQnO1xuaW1wb3J0IHsgY3VzdG9tRWxlbWVudCwgcHJvcGVydHksIHF1ZXJ5LCBvYnNlcnZlIH0gZnJvbSAnQHBvbHltZXIvZGVjb3JhdG9ycy9saWIvZGVjb3JhdG9ycyc7XG5pbXBvcnQgeyBEYXRlVGltZSB9IGZyb20gJ2RvcGVlcy1jb3JlL2xpYi9kYXRldGltZSc7XG5pbXBvcnQgeyBzcHJpbnRmIH0gZnJvbSAnZG9wZWVzLWNvcmUvbGliL3N0cmluZyc7XG5pbXBvcnQgeyBWYWx1ZUZpZWxkIH0gZnJvbSAnLi9maWVsZCc7XG5pbXBvcnQgeyBQaWNrZXIgfSBmcm9tICcuL3BpY2tlcic7XG5pbXBvcnQgeyBEYXRlRmllbGQgfSBmcm9tICcuL2RhdGUtZmllbGQnO1xuaW1wb3J0IHsgRGF0ZVRpbWVSYW5nZSB9IGZyb20gJy4vZGF0ZS1yYW5nZS1maWVsZCc7XG5cbkBjdXN0b21FbGVtZW50KCdkb3BlLWRhdGUtcmFuZ2UtcGlja2VyJylcbmV4cG9ydCBjbGFzcyBEYXRlUmFuZ2VQaWNrZXIgZXh0ZW5kcyBQaWNrZXI8RGF0ZVRpbWVSYW5nZT4gaW1wbGVtZW50cyBWYWx1ZUZpZWxkPERhdGVUaW1lUmFuZ2U+IHtcbiAgc3RhdGljIGdldCB0ZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gUGlja2VyLmNyZWF0ZVRlbXBsYXRlKERhdGVSYW5nZVBpY2tlciwge1xuICAgICAgaW1wbGVtZW50YXRpb246ICdkb3BlLWRhdGUtcmFuZ2UtZmllbGQnLFxuICAgICAgYXJndW1lbnRzOiB7XG4gICAgICAgIHllYXJzOiAnW1t5ZWFyc11dJyxcbiAgICAgICAgbW9udGhzOiAnW1ttb250aHNdXScsXG4gICAgICAgIHNlbGVjdGlvbjogJ1tbc2VsZWN0aW9uXV0nLFxuICAgICAgICB2YWx1ZTogJ3t7dmFsdWV9fScsXG4gICAgICAgICdzdGFydC1kYXRlJzogJ3t7c3RhcnREYXRlfX0nLFxuICAgICAgICAnZW5kLWRhdGUnOiAne3tlbmREYXRlfX0nXG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIF9fdmFsdWVDaGFuZ2luZzogYW55O1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IE9iamVjdCwgbm90aWZ5OiB0cnVlIH0pXG4gIHZhbHVlOiBEYXRlVGltZVJhbmdlID0ge307XG5cbiAgQHByb3BlcnR5KHt0eXBlOiBPYmplY3QsIG5vdGlmeTogdHJ1ZSB9KVxuICBzdGFydERhdGU6IERhdGVUaW1lfHVuZGVmaW5lZDtcblxuICBAcHJvcGVydHkoe3R5cGU6IE9iamVjdCwgbm90aWZ5OiB0cnVlIH0pXG4gIGVuZERhdGU6IERhdGVUaW1lfHVuZGVmaW5lZDtcblxuICBAcHJvcGVydHkoKVxuICBmb3JtYXR0ZXI6IChpdGVtOiBEYXRlVGltZVJhbmdlKSA9PiBzdHJpbmc7XG5cbiAgQHByb3BlcnR5KClcbiAgc2VsZWN0aW9uOiAoZGF0ZTogRGF0ZVRpbWUpID0+IGJvb2xlYW4gPSAoKSA9PiBmYWxzZVxuXG4gIEBxdWVyeSgnZG9wZS1kYXRlLXJhbmdlLWZpZWxkJylcbiAgaW5uZXJGaWVsZCE6IERhdGVGaWVsZDtcblxuICBjb25zdHJ1Y3RvcigpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuZm9ybWF0dGVyID0gKHgpID0+IHtcbiAgICAgIGlmICgheCkge1xuICAgICAgICByZXR1cm4gdGhpcy5wbGFjZWhvbGRlciB8fCAnJztcbiAgICAgIH1cbiAgICAgIGlmICh4LnN0YXJ0KSB7XG4gICAgICAgIGlmICh4LmVuZCkge1xuICAgICAgICAgIHJldHVybiBzcHJpbnRmKFxuICAgICAgICAgICAgJyUwNGQuICUwMmQuICUwMmQgLS0gJTA0ZC4gJTAyZC4gJTAyZCcsXG4gICAgICAgICAgICB4LnN0YXJ0LnllYXIsXG4gICAgICAgICAgICB4LnN0YXJ0Lm1vbnRoLFxuICAgICAgICAgICAgeC5zdGFydC5kYXksXG4gICAgICAgICAgICB4LmVuZC55ZWFyLFxuICAgICAgICAgICAgeC5lbmQubW9udGgsXG4gICAgICAgICAgICB4LmVuZC5kYXkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzcHJpbnRmKCclMDRkLiAlMDJkLiAlMDJkJywgeC5zdGFydC55ZWFyLCB4LnN0YXJ0Lm1vbnRoLCB4LnN0YXJ0LmRheSk7XG4gICAgICB9XG4gICAgICBpZiAoeC5lbmQpIHtcbiAgICAgICAgcmV0dXJuIHNwcmludGYoJyUwNGQuICUwMmQuICUwMmQnLCB4LmVuZC55ZWFyLCB4LmVuZC5tb250aCwgeC5lbmQuZGF5KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLnBsYWNlaG9sZGVyIHx8ICcnO1xuICAgIH07XG4gIH1cblxuICBhY3RpdmF0ZSgpIHtcbiAgICB0aGlzLndyYXBwZXIuZm9jdXMoKTtcbiAgICB0aGlzLmlubmVyRmllbGQuYWN0aXZhdGUoKTtcbiAgfVxuXG4gIEBvYnNlcnZlKCdlbXB0eScpXG4gIGZvcmNlRW1wdHkoZW1wdHk6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmRyb3BEb3duLmZvcmNlZEVtcHR5ID0gZW1wdHk7XG4gIH1cblxuICBAb2JzZXJ2ZSgndmFsdWUnKVxuICBvYnNlcnZlRW1wdHkodmFsdWU6IERhdGVUaW1lUmFuZ2V8dW5kZWZpbmVkKSB7XG4gICAgdGhpcy5lbXB0eSA9ICF2YWx1ZSB8fCAhKHZhbHVlLnN0YXJ0IHx8IHZhbHVlLmVuZCk7XG4gIH1cblxuICBAb2JzZXJ2ZSgndmFsdWUnKVxuICB2YWx1ZUNoYW5nZWQodmFsdWU6IERhdGVUaW1lUmFuZ2UpIHtcbiAgICB0aGlzLl9fdmFsdWVDaGFuZ2luZyA9IHRydWU7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuc3RhcnREYXRlID0gdmFsdWUuc3RhcnQ7XG4gICAgICB0aGlzLmVuZERhdGUgPSB2YWx1ZS5lbmQ7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuX192YWx1ZUNoYW5naW5nID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgQG9ic2VydmUoJ3N0YXJ0RGF0ZScsICdlbmREYXRlJylcbiAgdmFsdWVzQ2hhbmdlZChzdGFydDogRGF0ZVRpbWV8dW5kZWZpbmVkLCBlbmQ6IERhdGVUaW1lfHVuZGVmaW5lZCkge1xuICAgIGlmIChzdGFydCkge1xuICAgICAgaWYgKGVuZCkge1xuICAgICAgICB0aGlzLnNlbGVjdGlvbiA9IChkYXRlOiBEYXRlVGltZSkgPT4gMCA8PSBkYXRlLmNvbXBhcmVUbyhzdGFydCkgJiYgMCA+PSBkYXRlLmNvbXBhcmVUbyhlbmQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb24gPSAoZGF0ZTogRGF0ZVRpbWUpID0+IGRhdGUuZXF1YWxzVG8oc3RhcnQpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoZW5kKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uID0gKGRhdGU6IERhdGVUaW1lKSA9PiBkYXRlLmVxdWFsc1RvKGVuZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNlbGVjdGlvbiA9ICgpID0+IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXRoaXMuX192YWx1ZUNoYW5naW5nKSB7XG4gICAgICB0aGlzLnZhbHVlID0geyBzdGFydCwgZW5kIH07XG4gICAgfVxuICB9XG59XG4iXSwic291cmNlUm9vdCI6IiJ9