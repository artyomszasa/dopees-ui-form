var __decorate = this && this.__decorate || function (decorators, target, key, desc) {
  var c = arguments.length,
      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,
      d;
  if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
  return c > 3 && r && Object.defineProperty(target, key, r), r;
};

var DateRangePicker_1;
import "./date-range-field/date-range-field.js";
import { customElement, property, query, observe } from "@polymer/decorators/lib/decorators.js";
import { sprintf } from "dopees-core/lib/string.js";
import { Picker } from "./picker/picker.js";
let DateRangePicker = DateRangePicker_1 = class DateRangePicker extends Picker {
  constructor() {
    super();
    this.value = {};

    this.selection = () => false;

    this.formatter = x => {
      if (!x) {
        return this.placeholder || '';
      }

      if (x.start) {
        if (x.end) {
          return sprintf('%04d. %02d. %02d -- %04d. %02d. %02d', x.start.year, x.start.month, x.start.day, x.end.year, x.end.month, x.end.day);
        }

        return sprintf('%04d. %02d. %02d', x.start.year, x.start.month, x.start.day);
      }

      if (x.end) {
        return sprintf('%04d. %02d. %02d', x.end.year, x.end.month, x.end.day);
      }

      return this.placeholder || '';
    };
  }

  static get template() {
    return Picker.createTemplate(DateRangePicker_1, {
      implementation: 'dope-date-range-field',
      arguments: {
        years: '[[years]]',
        months: '[[months]]',
        selection: '[[selection]]',
        value: '{{value}}',
        'start-date': '{{startDate}}',
        'end-date': '{{endDate}}'
      }
    });
  }

  activate() {
    this.wrapper.focus();
    this.innerField.activate();
  }

  forceEmpty(empty) {
    this.dropDown.forcedEmpty = empty;
  }

  observeEmpty(value) {
    this.empty = !value || !(value.start || value.end);
  }

  valueChanged(value) {
    this.__valueChanging = true;

    try {
      this.startDate = value.start;
      this.endDate = value.end;
    } finally {
      this.__valueChanging = false;
    }
  }

  valuesChanged(start, end) {
    if (start) {
      if (end) {
        this.selection = date => 0 <= date.compareTo(start) && 0 >= date.compareTo(end);
      } else {
        this.selection = date => date.equalsTo(start);
      }
    } else {
      if (end) {
        this.selection = date => date.equalsTo(end);
      } else {
        this.selection = () => false;
      }
    }

    if (!this.__valueChanging) {
      this.value = {
        start,
        end
      };
    }
  }

};

__decorate([property({
  type: Object,
  notify: true
})], DateRangePicker.prototype, "value", void 0);

__decorate([property({
  type: Object,
  notify: true
})], DateRangePicker.prototype, "startDate", void 0);

__decorate([property({
  type: Object,
  notify: true
})], DateRangePicker.prototype, "endDate", void 0);

__decorate([property()], DateRangePicker.prototype, "formatter", void 0);

__decorate([property()], DateRangePicker.prototype, "selection", void 0);

__decorate([query('dope-date-range-field')], DateRangePicker.prototype, "innerField", void 0);

__decorate([observe('empty')], DateRangePicker.prototype, "forceEmpty", null);

__decorate([observe('value')], DateRangePicker.prototype, "observeEmpty", null);

__decorate([observe('value')], DateRangePicker.prototype, "valueChanged", null);

__decorate([observe('startDate', 'endDate')], DateRangePicker.prototype, "valuesChanged", null);

DateRangePicker = DateRangePicker_1 = __decorate([customElement('dope-date-range-picker')], DateRangePicker);
export { DateRangePicker };
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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ZSxFQUFBLE1BQU0sRUFBRTtBQUF2QixDQUFELENBQ1QsQ0FBQSxFLHlCQUFBLEUsU0FBQSxFLEtBQTRCLENBQTVCLENBQUE7O0FBR0EsVUFBQSxDQUFBLENBREMsUUFBUSxFQUNULENBQUEsRSx5QkFBQSxFLFdBQUEsRSxLQUEyQyxDQUEzQyxDQUFBOztBQUdBLFVBQUEsQ0FBQSxDQURDLFFBQVEsRUFDVCxDQUFBLEUseUJBQUEsRSxXQUFBLEUsS0FBcUQsQ0FBckQsQ0FBQTs7QUFHQSxVQUFBLENBQUEsQ0FEQyxLQUFLLENBQUMsdUJBQUQsQ0FDTixDQUFBLEUseUJBQUEsRSxZQUFBLEUsS0FBdUIsQ0FBdkIsQ0FBQTs7QUEyQkEsVUFBQSxDQUFBLENBREMsT0FBTyxDQUFDLE9BQUQsQ0FDUixDQUFBLEUseUJBQUEsRSxZQUFBLEVBRUMsSUFGRCxDQUFBOztBQUtBLFVBQUEsQ0FBQSxDQURDLE9BQU8sQ0FBQyxPQUFELENBQ1IsQ0FBQSxFLHlCQUFBLEUsY0FBQSxFQUVDLElBRkQsQ0FBQTs7QUFLQSxVQUFBLENBQUEsQ0FEQyxPQUFPLENBQUMsT0FBRCxDQUNSLENBQUEsRSx5QkFBQSxFLGNBQUEsRUFRQyxJQVJELENBQUE7O0FBV0EsVUFBQSxDQUFBLENBREMsT0FBTyxDQUFDLFdBQUQsRUFBYyxTQUFkLENBQ1IsQ0FBQSxFLHlCQUFBLEUsZUFBQSxFQWlCQyxJQWpCRCxDQUFBOztBQWpGVyxlQUFlLEdBQUEsaUJBQUEsR0FBQSxVQUFBLENBQUEsQ0FEM0IsYUFBYSxDQUFDLHdCQUFELENBQ2MsQ0FBQSxFQUFmLGVBQWUsQ0FBZjtTQUFBLGUiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJy4vZGF0ZS1yYW5nZS1maWVsZC9kYXRlLXJhbmdlLWZpZWxkJztcbmltcG9ydCB7IGN1c3RvbUVsZW1lbnQsIHByb3BlcnR5LCBxdWVyeSwgb2JzZXJ2ZSB9IGZyb20gJ0Bwb2x5bWVyL2RlY29yYXRvcnMvbGliL2RlY29yYXRvcnMnO1xuaW1wb3J0IHsgRGF0ZVRpbWUgfSBmcm9tICdkb3BlZXMtY29yZS9saWIvZGF0ZXRpbWUnO1xuaW1wb3J0IHsgc3ByaW50ZiB9IGZyb20gJ2RvcGVlcy1jb3JlL2xpYi9zdHJpbmcnO1xuaW1wb3J0IHsgVmFsdWVGaWVsZCB9IGZyb20gJy4vZmllbGQnO1xuaW1wb3J0IHsgUGlja2VyIH0gZnJvbSAnLi9waWNrZXIvcGlja2VyJztcbmltcG9ydCB7IERhdGVGaWVsZCB9IGZyb20gJy4vZGF0ZS1maWVsZC9kYXRlLWZpZWxkJztcbmltcG9ydCB7IERhdGVUaW1lUmFuZ2UgfSBmcm9tICcuL2RhdGUtcmFuZ2UtZmllbGQvZGF0ZS1yYW5nZS1maWVsZCc7XG5cbkBjdXN0b21FbGVtZW50KCdkb3BlLWRhdGUtcmFuZ2UtcGlja2VyJylcbmV4cG9ydCBjbGFzcyBEYXRlUmFuZ2VQaWNrZXIgZXh0ZW5kcyBQaWNrZXI8RGF0ZVRpbWVSYW5nZT4gaW1wbGVtZW50cyBWYWx1ZUZpZWxkPERhdGVUaW1lUmFuZ2U+IHtcbiAgc3RhdGljIGdldCB0ZW1wbGF0ZSgpIHtcbiAgICByZXR1cm4gUGlja2VyLmNyZWF0ZVRlbXBsYXRlKERhdGVSYW5nZVBpY2tlciwge1xuICAgICAgaW1wbGVtZW50YXRpb246ICdkb3BlLWRhdGUtcmFuZ2UtZmllbGQnLFxuICAgICAgYXJndW1lbnRzOiB7XG4gICAgICAgIHllYXJzOiAnW1t5ZWFyc11dJyxcbiAgICAgICAgbW9udGhzOiAnW1ttb250aHNdXScsXG4gICAgICAgIHNlbGVjdGlvbjogJ1tbc2VsZWN0aW9uXV0nLFxuICAgICAgICB2YWx1ZTogJ3t7dmFsdWV9fScsXG4gICAgICAgICdzdGFydC1kYXRlJzogJ3t7c3RhcnREYXRlfX0nLFxuICAgICAgICAnZW5kLWRhdGUnOiAne3tlbmREYXRlfX0nXG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBwcml2YXRlIF9fdmFsdWVDaGFuZ2luZzogYW55O1xuXG4gIEBwcm9wZXJ0eSh7IHR5cGU6IE9iamVjdCwgbm90aWZ5OiB0cnVlIH0pXG4gIHZhbHVlOiBEYXRlVGltZVJhbmdlID0ge307XG5cbiAgQHByb3BlcnR5KHt0eXBlOiBPYmplY3QsIG5vdGlmeTogdHJ1ZSB9KVxuICBzdGFydERhdGU6IERhdGVUaW1lfHVuZGVmaW5lZDtcblxuICBAcHJvcGVydHkoe3R5cGU6IE9iamVjdCwgbm90aWZ5OiB0cnVlIH0pXG4gIGVuZERhdGU6IERhdGVUaW1lfHVuZGVmaW5lZDtcblxuICBAcHJvcGVydHkoKVxuICBmb3JtYXR0ZXI6IChpdGVtOiBEYXRlVGltZVJhbmdlKSA9PiBzdHJpbmc7XG5cbiAgQHByb3BlcnR5KClcbiAgc2VsZWN0aW9uOiAoZGF0ZTogRGF0ZVRpbWUpID0+IGJvb2xlYW4gPSAoKSA9PiBmYWxzZTtcblxuICBAcXVlcnkoJ2RvcGUtZGF0ZS1yYW5nZS1maWVsZCcpXG4gIGlubmVyRmllbGQhOiBEYXRlRmllbGQ7XG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLmZvcm1hdHRlciA9IHggPT4ge1xuICAgICAgaWYgKCF4KSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBsYWNlaG9sZGVyIHx8ICcnO1xuICAgICAgfVxuICAgICAgaWYgKHguc3RhcnQpIHtcbiAgICAgICAgaWYgKHguZW5kKSB7XG4gICAgICAgICAgcmV0dXJuIHNwcmludGYoJyUwNGQuICUwMmQuICUwMmQgLS0gJTA0ZC4gJTAyZC4gJTAyZCcsIHguc3RhcnQueWVhciwgeC5zdGFydC5tb250aCwgeC5zdGFydC5kYXksIHguZW5kLnllYXIsIHguZW5kLm1vbnRoLCB4LmVuZC5kYXkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzcHJpbnRmKCclMDRkLiAlMDJkLiAlMDJkJywgeC5zdGFydC55ZWFyLCB4LnN0YXJ0Lm1vbnRoLCB4LnN0YXJ0LmRheSk7XG4gICAgICB9XG4gICAgICBpZiAoeC5lbmQpIHtcbiAgICAgICAgcmV0dXJuIHNwcmludGYoJyUwNGQuICUwMmQuICUwMmQnLCB4LmVuZC55ZWFyLCB4LmVuZC5tb250aCwgeC5lbmQuZGF5KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLnBsYWNlaG9sZGVyIHx8ICcnO1xuICAgIH07XG4gIH1cblxuICBhY3RpdmF0ZSgpIHtcbiAgICB0aGlzLndyYXBwZXIuZm9jdXMoKTtcbiAgICB0aGlzLmlubmVyRmllbGQuYWN0aXZhdGUoKTtcbiAgfVxuXG4gIEBvYnNlcnZlKCdlbXB0eScpXG4gIGZvcmNlRW1wdHkoZW1wdHk6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmRyb3BEb3duLmZvcmNlZEVtcHR5ID0gZW1wdHk7XG4gIH1cblxuICBAb2JzZXJ2ZSgndmFsdWUnKVxuICBvYnNlcnZlRW1wdHkodmFsdWU6IERhdGVUaW1lUmFuZ2V8dW5kZWZpbmVkKSB7XG4gICAgdGhpcy5lbXB0eSA9ICF2YWx1ZSB8fCAhKHZhbHVlLnN0YXJ0IHx8IHZhbHVlLmVuZCk7XG4gIH1cblxuICBAb2JzZXJ2ZSgndmFsdWUnKVxuICB2YWx1ZUNoYW5nZWQodmFsdWU6IERhdGVUaW1lUmFuZ2UpIHtcbiAgICB0aGlzLl9fdmFsdWVDaGFuZ2luZyA9IHRydWU7XG4gICAgdHJ5IHtcbiAgICAgIHRoaXMuc3RhcnREYXRlID0gdmFsdWUuc3RhcnQ7XG4gICAgICB0aGlzLmVuZERhdGUgPSB2YWx1ZS5lbmQ7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIHRoaXMuX192YWx1ZUNoYW5naW5nID0gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgQG9ic2VydmUoJ3N0YXJ0RGF0ZScsICdlbmREYXRlJylcbiAgdmFsdWVzQ2hhbmdlZChzdGFydDogRGF0ZVRpbWV8dW5kZWZpbmVkLCBlbmQ6IERhdGVUaW1lfHVuZGVmaW5lZCkge1xuICAgIGlmIChzdGFydCkge1xuICAgICAgaWYgKGVuZCkge1xuICAgICAgICB0aGlzLnNlbGVjdGlvbiA9IChkYXRlOiBEYXRlVGltZSkgPT4gMCA8PSBkYXRlLmNvbXBhcmVUbyhzdGFydCkgJiYgMCA+PSBkYXRlLmNvbXBhcmVUbyhlbmQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zZWxlY3Rpb24gPSAoZGF0ZTogRGF0ZVRpbWUpID0+IGRhdGUuZXF1YWxzVG8oc3RhcnQpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoZW5kKSB7XG4gICAgICAgIHRoaXMuc2VsZWN0aW9uID0gKGRhdGU6IERhdGVUaW1lKSA9PiBkYXRlLmVxdWFsc1RvKGVuZCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnNlbGVjdGlvbiA9ICgpID0+IGZhbHNlO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIXRoaXMuX192YWx1ZUNoYW5naW5nKSB7XG4gICAgICB0aGlzLnZhbHVlID0geyBzdGFydCwgZW5kIH07XG4gICAgfVxuICB9XG59Il0sInNvdXJjZVJvb3QiOiIifQ==